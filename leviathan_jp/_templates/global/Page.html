{% extends "otree/Page.html" %}
{% load otree static %}

{% block global_styles  %}
{% endblock %}

{% block global_scripts  %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        if (document && document.documentElement) {
            document.documentElement.setAttribute('lang', 'ja');
        }
        document.querySelectorAll('[required]').forEach(function(el) {
            el.addEventListener('invalid', function () {
                this.setCustomValidity('この項目は必須です。');
            });
            el.addEventListener('input', function () {
                this.setCustomValidity('');
            });
        });

        document.addEventListener('keydown', function(event) {
            if (event.key !== 'Enter') {
                return;
            }

            var active = document.activeElement;
            var tag = active ? active.tagName : '';
            if (active && (
                active.isContentEditable ||
                tag === 'INPUT' ||
                tag === 'TEXTAREA' ||
                tag === 'SELECT'
            )) {
                return;
            }

            var nextButton = document.querySelector('button.otree-next-button');
            if (nextButton && nextButton.disabled) {
                return;
            }

            var form = document.querySelector('form.otree-form');
            if (!form) {
                return;
            }

            event.preventDefault();

            if (typeof form.requestSubmit === 'function') {
                form.requestSubmit();
            } else {
                form.submit();
            }
        });
    });
</script>
{% endblock %}
