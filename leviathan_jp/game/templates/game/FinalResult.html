{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    最終結果
{% endblock %}

{% block content %}

<div class="stage-layout">
    <div class="stage-header">
        <div>
            <div class="stage-title">最終結果</div>
            <div class="stage-subtitle">全 {{ C.num_rounds }} ラウンドの結果</div>
        </div>
        <div class="stage-desc">
            実験は終了しました。グループ全員の累積利得を表示します。
        </div>
    </div>

    <div class="stage-center">
        <div class="player-grid" style="gap: 2.2rem;">
            {% for p in players %}
            <div class="player-card" style="--idx: {{ forloop.counter0 }};">
                <div class="player-label">
                    {% if p.id_in_group == player.id_in_group %}
                        <strong>あなた</strong>
                    {% else %}
                        プレイヤー {{ p.id_in_group }}
                    {% endif %}
                </div>
                <div class="summary-chip">{{ p.participant.payoff }}</div>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="stage-footer">
        <div class="matrix-note" style="max-width: 620px; text-align: center;">
            あなたの累積利得は {{ participant.payoff }} です。<br>
            換金レート (1 MU = {{ session.config.real_world_currency_per_point }} {{ currency_code }}) に基づく成績報酬は {{ performance_payoff }}、
            参加費 {{ session.config.participation_fee }} {{ currency_code }} を含めた最終支払額は {{ final_payoff_jpy }} {{ currency_code }} です。
        </div>
        {% next_button %}
    </div>
</div>

{% endblock %}
